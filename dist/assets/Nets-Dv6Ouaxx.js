import{r as i,u as y,j as e,a as k,L as h,P as _,b as p,s as f}from"./index-Blpl3ZWD.js";import{A as g,U as S}from"./users-D-zPr7A-.js";import{R as d}from"./radio-DXwSCmD4.js";import{C as N}from"./calendar-CYh-SL29.js";import{S as b}from"./signal-CyNXPRgU.js";import{C as E}from"./chevron-right-CTHpO3AC.js";import{f as L}from"./format-ujySDKAB.js";function U(){const[n,c]=i.useState(!0),[j,u]=i.useState([]),x=y();if(i.useEffect(()=>{(async()=>{const r=setTimeout(()=>{n&&(console.error("Nets: Data fetching timed out"),c(!1),p.error("Operations log synchronization timed out. Please refresh."))},1e4);try{console.log("Nets: Fetching session...");const{data:{session:a},error:m}=await f.auth.getSession();if(m)throw m;if(!a){console.log("Nets: No session, redirecting..."),x("/login");return}const v=a.user;console.log("Nets: Fetching nets...");const{data:l,error:o}=await f.from("nets").select("*, checkins(id)").eq("user_id",v.id).order("created_at",{ascending:!1});if(o)throw console.error("Nets: Fetch error:",o),o;console.log(`Nets: Loaded ${(l==null?void 0:l.length)||0} nets`),u(l||[])}catch(a){console.error("Nets: Critical error:",a),p.error(`System synchronization error: ${a.message||"Unknown error"}`)}finally{clearTimeout(r),c(!1)}})()},[x]),n)return e.jsx("div",{className:"flex items-center justify-center h-[80vh]",children:e.jsx(k,{className:"w-12 h-12 text-emerald-500 animate-spin"})});const t=j,w=s=>s.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase());return e.jsxs("main",{className:"h-screen pt-16 md:pt-20 overflow-hidden flex flex-col bg-slate-950",children:[e.jsx("div",{className:"px-4 md:px-6 py-4 border-b border-white/5 bg-slate-950/50 backdrop-blur-md z-20",children:e.jsxs("div",{className:"max-w-full mx-auto flex flex-col lg:flex-row lg:items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-2 py-0.5 rounded-full bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-[10px] font-mono mb-1",children:[e.jsx(g,{className:"w-3 h-3"}),"NET CONTROL LOGS"]}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white tracking-tight",children:"Operations Log"}),e.jsx("p",{className:"text-slate-500 text-[11px] font-mono mt-0.5",children:"HISTORY & ARCHIVE OF ON-AIR SESSIONS"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(h,{to:"/nets/new",className:"h-10 px-4 rounded-xl bg-emerald-600 text-white font-bold text-xs hover:bg-emerald-500 transition-all shadow-lg shadow-emerald-500/20 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Initialize Net"]})})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col p-4 md:p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card glass-card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center text-slate-400",children:e.jsx(d,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] uppercase font-bold text-slate-500 tracking-wider",children:"Total"}),e.jsx("p",{className:"text-lg font-mono font-bold text-white",children:t.length})]})]}),e.jsxs("div",{className:"card glass-card p-3 flex items-center gap-3 border-emerald-500/20",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-500/10 flex items-center justify-center text-emerald-400 border border-emerald-500/20",children:e.jsx(g,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] uppercase font-bold text-emerald-500 tracking-wider",children:"On-Air"}),e.jsx("p",{className:"text-lg font-mono font-bold text-emerald-400",children:t.filter(s=>!s.ended_at).length})]})]}),e.jsxs("div",{className:"card glass-card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-cyan-500/10 flex items-center justify-center text-cyan-400 border border-cyan-500/20",children:e.jsx(N,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] uppercase font-bold text-slate-500 tracking-wider",children:"Weekly"}),e.jsx("p",{className:"text-lg font-mono font-bold text-cyan-400",children:t.filter(s=>s.type==="weekly").length})]})]}),e.jsxs("div",{className:"card glass-card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-rose-500/10 flex items-center justify-center text-rose-400 border border-rose-500/20",children:e.jsx(b,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] uppercase font-bold text-slate-500 tracking-wider",children:"Exercises"}),e.jsx("p",{className:"text-lg font-mono font-bold text-rose-400",children:t.filter(s=>s.type==="emergency_exercise").length})]})]})]}),e.jsxs("div",{className:"flex-1 card glass-card overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-white/5 bg-slate-900/40",children:e.jsxs("h3",{className:"text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-emerald-500 rounded-full"}),"Historical Log"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:t.length===0?e.jsxs("div",{className:"p-16 text-center",children:[e.jsx(d,{className:"w-12 h-12 text-slate-700 mx-auto mb-4"}),e.jsx("h3",{className:"text-white font-bold mb-2",children:"No operations found"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Start a new net to begin logging."})]}):e.jsx("div",{className:"divide-y divide-white/5",children:t.map(s=>{var r;return e.jsxs(h,{to:`/nets/${s.id}`,className:"flex items-center justify-between p-4 hover:bg-white/5 transition-colors group relative overflow-hidden",children:[!s.ended_at&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-emerald-500 animate-pulse shadow-[0_0_8px_#10b981]"}),e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 border border-t-white/10 ${s.ended_at?"bg-slate-800/80 border-slate-700":"bg-gradient-to-br from-emerald-500 to-cyan-500 shadow-lg shadow-emerald-500/20"}`,children:e.jsx(d,{className:`w-5 h-5 ${s.ended_at?"text-slate-500":"text-white"}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-white group-hover:text-emerald-400 transition-colors uppercase truncate max-w-[300px]",children:s.name}),!s.ended_at&&e.jsx("span",{className:"text-[8px] font-bold text-emerald-500 px-1 border border-emerald-500/30 rounded animate-pulse",children:"LIVE"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-[10px] text-slate-500 font-mono italic mt-0.5",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"w-3 h-3"})," ",L(new Date(s.started_at),"MMM d, yyyy")]}),s.frequency&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"})," ",s.frequency]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("span",{className:`hidden md:inline-block px-2 py-0.5 rounded text-[9px] font-bold uppercase tracking-wider ${s.type==="weekly"?"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20":s.type==="emergency_exercise"?"bg-rose-500/10 text-rose-400 border border-rose-500/20":"bg-violet-500/10 text-violet-400 border border-violet-500/20"}`,children:w(s.type)}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 px-3 py-1 rounded-lg border border-white/5",children:[e.jsx(S,{className:"w-3 h-3 text-slate-500"}),e.jsx("span",{className:"text-xs font-mono font-bold text-white",children:((r=s.checkins)==null?void 0:r.length)||0})]}),e.jsx(E,{className:"w-5 h-5 text-slate-700 group-hover:text-emerald-500 group-hover:translate-x-1 transition-all"})]})]},s.id)})})})]})]})]})}export{U as default};
